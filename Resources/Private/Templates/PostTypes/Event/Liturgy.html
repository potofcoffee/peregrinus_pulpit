<p:output.pdf
        orientation="landscape"
        filename="{event.datetime -> p:format.date(format: 'Ymd')} Liturgie - {event.sermon.title}.pdf"
        leftmargin="10" rightmargin="10" topmargin="10" bottommargin="10"><!DOCTYPE html>
    <html lang="de">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="{baseUrl}/Resources/Public/Styles/Liturgy.css"
              media="all"/>
    </head>
<body>
    <table class="head" cellpadding="0" cellspacing="0">
        <tr>
            <td valign="top">
                <h1 >{event.title}</h1>
            </td>
            <td valign="top" style="font-size: 8pt; text-align: right;">
                <p:format.date format="d.m.Y">{event.datetime}</p:format.date>, {event.location.title} <br />
            </td>
        </tr>
    </table>
<table class="table">
    <tbody>
    <f:for each="{event.liturgy}" as="item">
        <tr>
            <f:switch expression="{item.type}">
                <f:case value="sectionTitle">
                    <th colspan="2" valign="top"><h3>{item.title}</h3></th>
                </f:case>
                <f:case value="descriptive">
                    <th valign="top">{item.title}</th>
                    <td valign="top"></td>
                </f:case>
                <f:case value="textBlock">
                    <th valign="top">{item.title}</th>
                    <td valign="top"></td>
                </f:case>
                <f:case value="freeText">
                    <th valign="top">{item.title}</th>
                    <td valign="top"></td>
                </f:case>
                <f:case value="song">
                    <th valign="top">{item.title}</th>
                    <td valign="top">
                        <f:if condition="{item.data.song.fromSongBook}">
                            <f:then>{item.data.song.nameAndNumber}<f:if condition="{item.data.verses}">, {item.data.verses}</f:if></f:then>
                            <f:else>"{item.data.song}"<f:if condition="{item.data.verses}">({item.data.verses})</f:if></f:else>
                        </f:if>
                    </td>
                </f:case>
                <f:case value="psalm">
                    <th valign="top">{item.title}</th>
                    <td valign="top">
                        <f:if condition="{item.data.song.fromSongBook}">
                            <f:then>{item.data.song.nameAndNumber}</f:then>
                            <f:else>{item.data.song}</f:else>
                        </f:if>
                    </td>
                </f:case>
                <f:case value="scriptureReading">
                    <th valign="top">{item.title}</th>
                    <td valign="top">{item.data.reference}</td>
                </f:case>
                <f:case value="sermon">
                    <th valign="top">{item.title}</th>
                    <td valign="top"><f:if condition="{event.sermon.title}">"{event.sermon.title}<f:if condition="{event.sermon.subtitle}">: {event.sermon.subtitle}</f:if>"<f:if condition="{event.sermon.reference}"> ({event.sermon.reference})</f:if></f:if></td>
                </f:case>
            </f:switch>
        </tr>
    </f:for>
    </tbody>
</table>
    <f:for each="{event.officiating -> p:format.explode()}" as="participant">
        <table class="head" style="page-break-before: always;" cellpadding="0" cellspacing="0">
            <tr>
                <td valign="top">
                    <h1 >{event.title}</h1>
                </td>
                <td valign="top" style="font-size: 8pt; text-align: right;">
                    <p:format.date format="d.m.Y">{event.datetime}</p:format.date>, {event.location.title} <br />
                    Plan f√ºr {participant}
                </td>
            </tr>
        </table>
        <hr />
        <table class="table">
            <tbody>
            <f:for each="{event.liturgy}" as="item">
                <tr>
                    <f:if condition="{0: item.type} ==  {0: 'sectionTitle'}">
                        <f:then><td colspan="3" valign="top"><h3>{item.title}</h3></td></f:then>
                        <f:else>
                            <th valign="top">{item.title}</th>
                            <f:if condition="{item.instructions -> p:nested(index: '{participant -> p:format.explode(separator: \':\', index: 0)}')}">
                                <f:then>
                                    <td valign="top">
                                </f:then>
                                <f:else>
                                    <td valign="top" colspan="2">
                                </f:else>
                            </f:if>
                                <f:switch expression="{item.type}">
                                    <f:case value="song">
                                        <f:if condition="{item.data.song.fromSongBook}">
                                            <f:then>{item.data.song.nameAndNumber}<f:if condition="{item.data.verses}">, {item.data.verses}</f:if></f:then>
                                            <f:else>"{item.data.song}"<f:if condition="{item.data.verses}">({item.data.verses})</f:if></f:else>
                                        </f:if>
                                    </f:case>
                                    <f:case value="psalm">
                                        <f:if condition="{item.data.song.fromSongBook}">
                                            <f:then>{item.data.song.nameAndNumber}</f:then>
                                            <f:else>{item.data.song}</f:else>
                                        </f:if>
                                    </f:case>
                                    <f:case value="scriptureReading">
                                        {item.data.reference}
                                    </f:case>
                                    <f:case value="sermon">
                                        <f:if condition="{event.sermon.title}">"{event.sermon.title}<f:if condition="{event.sermon.subtitle}">: {event.sermon.subtitle}</f:if>"<f:if condition="{event.sermon.reference}"> ({event.sermon.reference})</f:if></f:if>
                                    </f:case>
                                </f:switch>
                                <f:if condition="{item.instructions -> p:nested(index: '{participant -> p:format.explode(separator: \':\', index: 0)}')}">
                                    <td><td valign="top" style="font-size: 8pt;">
                                    <p:format.nl2br>{item.instructions -> p:nested(index: '{participant -> p:format.explode(separator: \':\', index: 0)}')}</p:format.nl2br>
                                </f:if>
                            </td>
                        </f:else>
                    </f:if>
                </tr>
            </f:for>
            </tbody>
        </table>
    </f:for>
    </body>
</html>
</p:output.pdf>
